import{d as tt,r as g,w as et,o as st,R as r,k as b,S as ot,L as at,K as nt,U as J,M as e,N as i,$ as G,O as H,T as K,V as it,as as lt,W as rt,a3 as O,v as U,a2 as ct,J as l,X as dt,_ as ut}from"./index-COLuSNnH.js";import{E as pt}from"./index-7ADYuEsa.js";/* empty css              */import{N as ht}from"./index-DtBFF6eJ.js";import{fetchFundManagerInfo as mt,fetchManagerProfit as vt}from"./fundFast-BTB3GdVE.js";import"./use-id-Bb8U-BO_.js";const ft={class:"manager-page"},_t={key:0,class:"loading-container"},gt={class:"manager-header"},yt={class:"avatar-section"},xt=["src"],kt={key:1,class:"avatar-placeholder"},bt={class:"info-section"},Ct={class:"manager-name"},wt={class:"meta-row"},Pt={class:"meta-item"},Tt={class:"stats-card"},St={class:"stat-item"},Mt={class:"stat-value"},Rt={class:"stat-item"},Vt={class:"stat-item"},Nt={class:"stat-value"},$t={key:0,class:"section chart-section"},Dt={class:"chart-container"},Et={key:1,class:"section"},Lt={class:"experience-text"},zt={class:"section"},Bt={key:0,class:"fund-list"},Ft=["onClick"],At={class:"fund-main"},It={class:"fund-name"},Wt={class:"fund-code"},Jt={class:"fund-meta"},Gt={class:"fund-type"},Ht={class:"fund-size"},Kt={class:"fund-return"},Ot={class:"fund-date"},Ut={key:1,class:"empty-hint"},Xt=tt({__name:"Manager",setup(Yt){const X=lt(),$=rt(),D=g(X.params.code),a=g(null),y=g([]),C=g(!0),E=g(null);async function Y(){C.value=!0;try{a.value=await mt(D.value),a.value||O("暂无经理信息"),vt(D.value).then(n=>{y.value=n,U(()=>L())})}catch{O("加载失败")}finally{C.value=!1}}function L(){const n=E.value;if(!n||y.value.length<2)return;const t=n.getContext("2d");if(!t)return;const h=window.devicePixelRatio||1,m=n.getBoundingClientRect();n.width=m.width*h,n.height=m.height*h,t.scale(h,h);const p=m.width,c=m.height,s={top:20,right:16,bottom:30,left:50},B=p-s.left-s.right,w=c-s.top-s.bottom,d=y.value,F=d.map(o=>o.profit),A=Math.min(...F,0),f=Math.max(...F,0),P=f-A||1,x=getComputedStyle(document.documentElement),T=x.getPropertyValue("--text-secondary").trim()||"#888",q=x.getPropertyValue("--border-color").trim()||"#333",Q=x.getPropertyValue("--color-up").trim()||"#e74c3c",Z=x.getPropertyValue("--color-down").trim()||"#2ecc71";t.clearRect(0,0,p,c),t.strokeStyle=q,t.lineWidth=.5;const S=4;for(let o=0;o<=S;o++){const u=s.top+w/S*o;t.beginPath(),t.moveTo(s.left,u),t.lineTo(p-s.right,u),t.stroke();const k=f-P/S*o;t.fillStyle=T,t.font="11px system-ui",t.textAlign="right",t.fillText(`${k.toFixed(1)}%`,s.left-8,u+4)}if(A<0&&f>0){const o=s.top+(f-0)/P*w;t.strokeStyle=T,t.setLineDash([4,4]),t.beginPath(),t.moveTo(s.left,o),t.lineTo(p-s.right,o),t.stroke(),t.setLineDash([])}const v=d.map((o,u)=>({x:s.left+u/(d.length-1)*B,y:s.top+(f-o.profit)/P*w,profit:o.profit,date:o.date})),M=d[d.length-1].profit,R=t.createLinearGradient(0,s.top,0,c-s.bottom),_=M>=0?Q:Z;R.addColorStop(0,`${_}30`),R.addColorStop(1,`${_}05`);const V=v[0],N=v[v.length-1];t.fillStyle=R,t.beginPath(),t.moveTo(V.x,c-s.bottom),v.forEach(o=>t.lineTo(o.x,o.y)),t.lineTo(N.x,c-s.bottom),t.closePath(),t.fill(),t.strokeStyle=_,t.lineWidth=2,t.lineJoin="round",t.beginPath(),t.moveTo(V.x,V.y),v.forEach(o=>t.lineTo(o.x,o.y)),t.stroke(),t.fillStyle=T,t.font="10px system-ui",t.textAlign="center";const I=Math.min(4,d.length);for(let o=0;o<I;o++){const u=Math.floor(o*(d.length-1)/(I-1)),k=d[u],W=v[u];k&&W&&t.fillText(k.date.slice(5),W.x,c-8)}t.fillStyle=_,t.beginPath(),t.arc(N.x,N.y,4,0,Math.PI*2),t.fill(),t.fillStyle=_,t.font="bold 12px system-ui",t.textAlign="right",t.fillText(`${M>=0?"+":""}${M.toFixed(2)}%`,p-s.right,s.top-6)}et(()=>document.documentElement.getAttribute("data-theme"),()=>{U(()=>L())});function j(n){$.push(`/detail/${n}`)}function z(n){const t=parseFloat(n);return isNaN(t)?"":t>=0?"up":"down"}return st(Y),(n,t)=>{const h=ht,m=ct,p=pt,c=dt;return l(),r("div",ft,[b(h,{title:"基金经理","left-arrow":"",onClickLeft:t[0]||(t[0]=s=>ot($).back())}),C.value?(l(),r("div",_t,[b(m,{size:"36px",color:"var(--color-primary)"},{default:at(()=>[...t[2]||(t[2]=[G("加载中...",-1)])]),_:1})])):a.value?(l(),r(J,{key:2},[e("div",gt,[e("div",yt,[a.value.photo?(l(),r("img",{key:0,src:a.value.photo,class:"avatar",onError:t[1]||(t[1]=s=>s.target.style.display="none")},null,40,xt)):(l(),r("div",kt,[b(c,{name:"manager",size:"32"})]))]),e("div",bt,[e("h2",Ct,i(a.value.name),1),e("div",wt,[e("span",Pt,[b(c,{name:"clock-o"}),G(" 从业 "+i(a.value.workTime),1)])])])]),e("div",Tt,[e("div",St,[t[3]||(t[3]=e("span",{class:"stat-label"},"管理规模",-1)),e("span",Mt,i(a.value.fundSize),1)]),e("div",Rt,[t[4]||(t[4]=e("span",{class:"stat-label"},"最佳回报",-1)),e("span",{class:H(["stat-value",z(a.value.bestReturn)])},i(a.value.bestReturn),3)]),e("div",Vt,[t[5]||(t[5]=e("span",{class:"stat-label"},"在管基金",-1)),e("span",Nt,i(a.value.funds.length)+"只",1)])]),y.value.length>0?(l(),r("div",$t,[t[6]||(t[6]=e("div",{class:"section-title"},"任职收益走势",-1)),e("div",Dt,[e("canvas",{ref_key:"chartCanvas",ref:E,class:"profit-chart"},null,512)])])):K("",!0),a.value.experience?(l(),r("div",Et,[t[7]||(t[7]=e("div",{class:"section-title"},"从业经历",-1)),e("div",Lt,i(a.value.experience),1)])):K("",!0),e("div",zt,[t[10]||(t[10]=e("div",{class:"section-title"},"在管基金",-1)),a.value.funds.length>0?(l(),r("div",Bt,[(l(!0),r(J,null,it(a.value.funds,s=>(l(),r("div",{key:s.code,class:"fund-item",onClick:B=>j(s.code)},[e("div",At,[e("span",It,i(s.name),1),e("span",Wt,i(s.code),1)]),e("div",Jt,[e("span",Gt,i(s.type),1),e("span",Ht,"规模: "+i(s.size),1)]),e("div",Kt,[t[8]||(t[8]=e("span",{class:"return-label"},"任职回报",-1)),e("span",{class:H(["return-value",z(s.returnRate)])},i(s.returnRate),3)]),e("div",Ot," 任职日期: "+i(s.startDate),1)],8,Ft))),128))])):(l(),r("div",Ut,[...t[9]||(t[9]=[e("p",null,"受接口限制，暂无法获取基金列表",-1),e("p",{class:"sub-hint"},"可从基金详情页查看该基金信息",-1)])]))])],64)):(l(),nt(p,{key:1,description:"暂无经理信息"}))])}}}),oe=ut(Xt,[["__scopeId","data-v-0a0ad5c8"]]);export{oe as default};
