import{d as W,t as Z,k as a,U as D,G as Q,ai as Y,aj as tt,c as X,B as J,g as st,ak as et,j as at,u as ot,w as nt,a0 as lt,a1 as it,l as rt,X as O,y as G,al as dt,r as L,q as U,am as q,an as ct,ao as ut,o as mt,R as w,L as C,J as b,M as s,N as u,S as e,O as A,V as F,a8 as vt,K as ft,W as pt,a3 as yt,p as T,_ as _t}from"./index-COLuSNnH.js";/* empty css              */import{P as gt}from"./index-lh23UwTI.js";import{C as ht}from"./index-BR0IqM1Y.js";import{S as bt}from"./index-C5fvOtBV.js";import{E as kt}from"./index-7ADYuEsa.js";import{N as xt}from"./index-DtBFF6eJ.js";import{u as wt}from"./holding-Cj-ioGV6.js";import{u as St}from"./trade-CO69ODrI.js";import{b as f,f as $t,g as j}from"./format-DMY7EWAz.js";import"./use-id-Bb8U-BO_.js";import"./storage-BvZjhTaj.js";import"./fundFast-BTB3GdVE.js";import"./fund-BsJItZTy.js";const[Ct,H]=X("cell-group"),Tt={title:String,inset:Boolean,border:Z};var Pt=W({name:Ct,inheritAttrs:!1,props:Tt,setup(i,{slots:r,attrs:l}){const p=()=>{var v;return a("div",Q({class:[H({inset:i.inset}),{[tt]:i.border&&!i.inset}]},l,Y()),[(v=r.default)==null?void 0:v.call(r)])},c=()=>a("div",{class:H("title",{inset:i.inset})},[r.title?r.title():i.title]);return()=>i.title||r.title?a(D,null,[c(),p()]):p()}});const Rt=J(Pt),[zt,P]=X("notice-bar"),Bt={text:String,mode:String,color:String,delay:G(1),speed:G(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var It=W({name:zt,props:Bt,emits:["close","replay"],setup(i,{emit:r,slots:l}){let p=0,c=0,v;const S=L(),_=L(),d=rt({show:!0,offset:0,duration:0}),B=()=>{if(l["left-icon"])return l["left-icon"]();if(i.leftIcon)return a(O,{class:P("left-icon"),name:i.leftIcon},null)},I=()=>{if(i.mode==="closeable")return"cross";if(i.mode==="link")return"arrow"},R=t=>{i.mode==="closeable"&&(d.show=!1,r("close",t))},V=()=>{if(l["right-icon"])return l["right-icon"]();const t=I();if(t)return a(O,{name:t,class:P("right-icon"),onClick:R},null)},k=()=>{d.offset=p,d.duration=0,dt(()=>{U(()=>{d.offset=-c,d.duration=(c+p)/+i.speed,r("replay")})})},M=()=>{const t=i.scrollable===!1&&!i.wrapable,o={transform:d.offset?`translateX(${d.offset}px)`:"",transitionDuration:`${d.duration}s`};return a("div",{ref:S,role:"marquee",class:P("wrap")},[a("div",{ref:_,style:o,class:[P("content"),{"van-ellipsis":t}],onTransitionend:k},[l.default?l.default():i.text])])},m=()=>{const{delay:t,speed:o,scrollable:y}=i,x=ct(t)?+t*1e3:0;p=0,c=0,d.offset=0,d.duration=0,clearTimeout(v),v=setTimeout(()=>{if(!S.value||!_.value||y===!1)return;const g=q(S).width,h=q(_).width;(y||h>g)&&U(()=>{p=g,c=h,d.offset=-c,d.duration=c/+o})},x)};return st(m),et(m),at("pageshow",m),ot({reset:m}),nt(()=>[i.text,i.scrollable],m),()=>{const{color:t,wrapable:o,background:y}=i;return lt(a("div",{role:"alert",class:P({wrapable:o}),style:{color:t,background:y}},[B(),M(),V()]),[[it,d.show]])}}});const Vt=J(It),Mt={class:"analysis-page"},Et={class:"summary-card"},Nt={class:"summary-header"},At={class:"value"},Dt={class:"summary-grid"},Ot={class:"summary-item"},Lt={class:"summary-item"},Wt={class:"summary-item"},Gt={class:"summary-item"},Ut={class:"item-value"},qt={class:"section"},Ft={key:0,class:"allocation-content"},jt={class:"pie-chart"},Ht={viewBox:"0 0 200 200"},Xt=["d","fill"],Jt=["fill"],Kt=["fill"],Zt=["fill"],Qt={class:"allocation-list"},Yt={class:"item-info"},ts={class:"item-name"},ss={class:"item-ratio"},es={class:"item-value"},as={class:"section"},os={class:"trade-stats"},ns={class:"trade-stat-item"},ls={class:"stat-info"},is={class:"stat-value"},rs={class:"trade-stat-item"},ds={class:"stat-info"},cs={class:"stat-value"},us={class:"trade-stat-item"},ms={class:"stat-info"},vs={class:"stat-value"},fs={class:"trade-stat-item"},ps={class:"stat-info"},ys={class:"stat-value"},_s={class:"net-invest"},gs={class:"net-value"},hs={class:"section"},bs={class:"tools-grid"},ks={class:"section"},xs={class:"tips-section"},ws=W({__name:"Analysis",setup(i){const r=pt(),l=wt(),p=St(),c=ut(),v=L(!1);mt(()=>{l.initHoldings()});async function S(){v.value=!0;try{await l.refreshEstimates(),yt("刷新成功")}finally{v.value=!1}}const _=T(()=>{const m=l.summary.totalValue;return m<=0?[]:l.holdings.filter(t=>t.marketValue&&t.marketValue>0).map(t=>({code:t.code,name:t.name,value:t.marketValue||0,ratio:(t.marketValue||0)/m*100})).sort((t,o)=>o.value-t.value)}),d=["#1989fa","#07c160","#ff976a","#ee0a24","#7232dd","#1cbbb4","#f2826a","#9191ff"];function B(m,t,o){const h=(m-90)*Math.PI/180,z=(t-90)*Math.PI/180,E=100+80*Math.cos(h),N=100+80*Math.sin(h),n=100+80*Math.cos(z),$=100+80*Math.sin(z),K=t-m>180?1:0;return{path:`M 100 100 L ${E} ${N} A 80 80 0 ${K} 1 ${n} ${$} Z`,color:d[o%d.length]||"#999"}}const I=T(()=>{const m=[];let t=0;return _.value.forEach((o,y)=>{const x=o.ratio/100*360,g=B(t,t+x,y);m.push({...g,name:o.name,ratio:o.ratio}),t+=x}),m}),R=T(()=>j(l.summary.totalProfit)),V=T(()=>j(l.summary.todayProfit)),k=T(()=>p.statistics);function M(){r.push("/trades")}return(m,t)=>{const o=O,y=xt,x=kt,g=bt,h=ht,z=Rt,E=Vt,N=gt;return b(),w("div",Mt,[a(y,{title:"数据分析"},{right:C(()=>[a(o,{name:"replay",size:"18",onClick:S})]),_:1}),a(N,{modelValue:v.value,"onUpdate:modelValue":t[11]||(t[11]=n=>v.value=n),onRefresh:S,class:"analysis-content"},{default:C(()=>[s("div",Et,[s("div",Nt,[t[12]||(t[12]=s("span",{class:"label"},"总资产",-1)),s("span",At,u(e(f)(e(l).summary.totalValue,"¥")),1)]),s("div",Dt,[s("div",Ot,[t[13]||(t[13]=s("span",{class:"item-label"},"持仓盈亏",-1)),s("span",{class:A(["item-value",R.value])},u(e(l).summary.totalProfit>=0?"+":"")+u(e(f)(e(l).summary.totalProfit)),3)]),s("div",Lt,[t[14]||(t[14]=s("span",{class:"item-label"},"收益率",-1)),s("span",{class:A(["item-value",R.value])},u(e($t)(e(l).summary.totalProfitRate)),3)]),s("div",Wt,[t[15]||(t[15]=s("span",{class:"item-label"},"今日收益",-1)),s("span",{class:A(["item-value",V.value])},u(e(l).summary.todayProfit>=0?"+":"")+u(e(f)(e(l).summary.todayProfit)),3)]),s("div",Gt,[t[16]||(t[16]=s("span",{class:"item-label"},"持仓成本",-1)),s("span",Ut,u(e(f)(e(l).summary.totalCost)),1)])])]),s("div",qt,[t[17]||(t[17]=s("div",{class:"section-header"},[s("span",{class:"section-title"},"资产配置")],-1)),_.value.length>0?(b(),w("div",Ft,[s("div",jt,[(b(),w("svg",Ht,[(b(!0),w(D,null,F(I.value,(n,$)=>(b(),w("path",{key:$,d:n.path,fill:n.color},null,8,Xt))),128)),s("circle",{cx:"100",cy:"100",r:"50",fill:e(c).actualTheme==="dark"?"var(--bg-secondary)":"white"},null,8,Jt),s("text",{x:"100",y:"95","text-anchor":"middle",fill:e(c).actualTheme==="dark"?"var(--text-secondary)":"#666","font-size":"12"},"持仓",8,Kt),s("text",{x:"100",y:"115","text-anchor":"middle",fill:e(c).actualTheme==="dark"?"var(--text-primary)":"#333","font-size":"14","font-weight":"bold"},u(_.value.length)+"只 ",9,Zt)]))]),s("div",Qt,[(b(!0),w(D,null,F(_.value,(n,$)=>(b(),w("div",{key:n.code,class:"allocation-item"},[s("div",{class:"item-color",style:vt({background:d[$%d.length]})},null,4),s("div",Yt,[s("span",ts,u(n.name),1),s("span",ss,u(n.ratio.toFixed(1))+"%",1)]),s("div",es,u(e(f)(n.value,"¥")),1)]))),128))])])):(b(),ft(x,{key:1,description:"暂无持仓数据"}))]),s("div",as,[s("div",{class:"section-header"},[t[18]||(t[18]=s("span",{class:"section-title"},"交易统计",-1)),s("span",{class:"section-action",onClick:M},"查看记录 >")]),s("div",os,[s("div",ns,[t[20]||(t[20]=s("div",{class:"stat-icon buy"},"买",-1)),s("div",ls,[t[19]||(t[19]=s("span",{class:"stat-label"},"累计买入",-1)),s("span",is,u(e(f)(k.value.totalBuy)),1)])]),s("div",rs,[t[22]||(t[22]=s("div",{class:"stat-icon sell"},"卖",-1)),s("div",ds,[t[21]||(t[21]=s("span",{class:"stat-label"},"累计卖出",-1)),s("span",cs,u(e(f)(k.value.totalSell)),1)])]),s("div",us,[t[24]||(t[24]=s("div",{class:"stat-icon dividend"},"分",-1)),s("div",ms,[t[23]||(t[23]=s("span",{class:"stat-label"},"累计分红",-1)),s("span",vs,u(e(f)(k.value.totalDividend)),1)])]),s("div",fs,[t[26]||(t[26]=s("div",{class:"stat-icon fee"},"费",-1)),s("div",ps,[t[25]||(t[25]=s("span",{class:"stat-label"},"累计手续费",-1)),s("span",ys,u(e(f)(k.value.totalFee)),1)])])]),s("div",_s,[t[27]||(t[27]=s("span",null,"净投入",-1)),s("span",gs,u(e(f)(k.value.netInvest,"¥")),1)])]),s("div",hs,[t[37]||(t[37]=s("div",{class:"section-header"},[s("span",{class:"section-title"},"实用工具")],-1)),s("div",bs,[s("div",{class:"tool-item",onClick:t[0]||(t[0]=n=>e(r).push("/compare"))},[a(o,{name:"chart-trending-o",size:"24"}),t[28]||(t[28]=s("span",null,"基金对比",-1))]),s("div",{class:"tool-item",onClick:t[1]||(t[1]=n=>e(r).push("/calculator"))},[a(o,{name:"calculator-o",size:"24"}),t[29]||(t[29]=s("span",null,"定投计算",-1))]),s("div",{class:"tool-item",onClick:t[2]||(t[2]=n=>e(r).push("/backtest"))},[a(o,{name:"replay",size:"24"}),t[30]||(t[30]=s("span",null,"回测模拟",-1))]),s("div",{class:"tool-item",onClick:t[3]||(t[3]=n=>e(r).push("/filter"))},[a(o,{name:"filter-o",size:"24"}),t[31]||(t[31]=s("span",null,"基金筛选",-1))]),s("div",{class:"tool-item",onClick:t[4]||(t[4]=n=>e(r).push("/trades"))},[a(o,{name:"orders-o",size:"24"}),t[32]||(t[32]=s("span",null,"交易记录",-1))]),s("div",{class:"tool-item",onClick:t[5]||(t[5]=n=>e(r).push("/alerts"))},[a(o,{name:"bell-o",size:"24"}),t[33]||(t[33]=s("span",null,"智能提醒",-1))]),s("div",{class:"tool-item",onClick:t[6]||(t[6]=n=>e(r).push("/report"))},[a(o,{name:"description-o",size:"24"}),t[34]||(t[34]=s("span",null,"收益报告",-1))]),s("div",{class:"tool-item",onClick:t[7]||(t[7]=n=>e(r).push("/calendar"))},[a(o,{name:"calendar-o",size:"24"}),t[35]||(t[35]=s("span",null,"投资日历",-1))]),s("div",{class:"tool-item",onClick:t[8]||(t[8]=n=>e(r).push("/manager-rank"))},[a(o,{name:"manager-o",size:"24"}),t[36]||(t[36]=s("span",null,"经理排行",-1))])])]),s("div",ks,[t[38]||(t[38]=s("div",{class:"section-header"},[s("span",{class:"section-title"},"设置")],-1)),a(z,{border:!1},{default:C(()=>[a(h,{title:"深色模式",center:""},{"right-icon":C(()=>[a(g,{"model-value":e(c).actualTheme==="dark","onUpdate:modelValue":t[9]||(t[9]=n=>e(c).toggleTheme()),size:"20px"},null,8,["model-value"])]),_:1}),a(h,{title:"跟随系统",center:""},{"right-icon":C(()=>[a(g,{"model-value":e(c).mode==="auto","onUpdate:modelValue":t[10]||(t[10]=n=>e(c).setTheme(n?"auto":e(c).actualTheme)),size:"20px"},null,8,["model-value"])]),_:1})]),_:1})]),s("div",xs,[a(E,{"left-icon":"volume-o",text:"投资有风险，数据仅供参考。基金过往业绩不代表未来表现。"})])]),_:1},8,["modelValue"])])}}}),Ds=_t(ws,[["__scopeId","data-v-47abb2df"]]);export{Ds as default};
