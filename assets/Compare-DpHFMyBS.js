const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fundFast-BTB3GdVE.js","assets/index-COLuSNnH.js","assets/index-DUg9U2wc.css"])))=>i.map(i=>d[i]);
import{d as A,o as O,a3 as $,av as W,R as d,k as p,L as x,M as n,U as h,V as k,T as _,$ as z,K as F,r as J,W as K,J as i,X as U,a8 as R,N as v,O as B,af as X,a2 as j,_ as q}from"./index-COLuSNnH.js";import{E as G}from"./index-7ADYuEsa.js";/* empty css              *//* empty css              */import{N as H}from"./index-DtBFF6eJ.js";import{u as Q}from"./fund-qjlmdvOA.js";import{fetchFundEstimateFast as Y}from"./fundFast-BTB3GdVE.js";import{B as Z}from"./index-dROw2vyl.js";import"./use-id-Bb8U-BO_.js";import"./storage-BvZjhTaj.js";const ee={class:"compare-page"},te={class:"selected-funds"},se={class:"fund-header"},ae=["onClick"],oe={class:"fund-name"},ne={class:"fund-code"},le={key:0,class:"fund-change"},re={key:0,class:"compare-section"},ie={class:"compare-table"},ce={class:"table-header"},ue={class:"row-cell period"},de={class:"legend"},me={class:"legend-item best"},pe={class:"legend-item worst"},y=4,ve=A({__name:"Compare",setup(fe){const g=K(),N=Q(),s=J([]),I=[{key:"1w",label:"近1周"},{key:"1m",label:"近1月"},{key:"3m",label:"近3月"},{key:"6m",label:"近6月"},{key:"1y",label:"近1年"},{key:"3y",label:"近3年"}],b=["#2563eb","#f56c6c","#67c23a","#e6a23c"];O(()=>{N.watchlist.slice(0,2).forEach(e=>{E(e.code,e.name)})});async function E(t,e){if(s.value.length>=y){$(`最多对比${y}只基金`);return}if(s.value.find(l=>l.code===t)){$("该基金已在对比列表中");return}const a={code:t,name:e,periodReturns:[],loading:!0};s.value.push(a);try{const[l,c]=await Promise.all([Y(t).catch(()=>null),W(t).catch(()=>[])]),r=s.value.findIndex(u=>u.code===t);r!==-1&&(s.value[r].estimate=l||void 0,s.value[r].periodReturns=c,s.value[r].loading=!1)}catch{const l=s.value.findIndex(c=>c.code===t);l!==-1&&(s.value[l].loading=!1)}}function L(t){s.value=s.value.filter(e=>e.code!==t)}async function S(){const{clearFundCache:t}=await X(async()=>{const{clearFundCache:a}=await import("./fundFast-BTB3GdVE.js");return{clearFundCache:a}},__vite__mapDeps([0,1,2]));s.value.forEach(a=>{t(a.code),localStorage.removeItem(`fund_period_ext_${a.code}`)});const e=[...s.value];s.value=[];for(const a of e)await E(a.code,a.name)}function f(t,e){return t.periodReturns.find(l=>l.period===e)?.fundReturn??null}function T(t,e,a){const l=t.map(r=>({code:r.code,value:f(r,e)})).filter(r=>r.value!==null);if(l.length<2)return"";const c=[...l].sort((r,u)=>u.value-r.value);return c[0]?.code===a?"best":c[c.length-1]?.code===a?"worst":""}function V(t){return t===null?"--":`${t>=0?"+":""}${t.toFixed(2)}%`}function M(t,e,a){const l=t.map(u=>f(u,e)).filter(u=>u!==null);if(l.length===0)return"0%";const c=Math.max(...l.map(Math.abs)),r=f(t.find(u=>u.code===a),e);return r===null||c===0?"0%":`${Math.abs(r/c)*100}%`}function D(){g.back()}function w(){g.push("/search")}function P(t){g.push(`/detail/${t}`)}return(t,e)=>{const a=U,l=H,c=j,r=Z,u=G;return i(),d("div",ee,[p(l,{title:"基金对比","left-arrow":"",onClickLeft:D},{right:x(()=>[p(a,{name:"replay",size:"20",style:{"margin-right":"12px"},onClick:S}),s.value.length<y?(i(),F(a,{key:0,name:"plus",size:"20",onClick:w})):_("",!0)]),_:1}),n("div",te,[(i(!0),d(h,null,k(s.value,(o,m)=>(i(),d("div",{key:o.code,class:"fund-card",style:R({borderLeftColor:b[m]})},[n("div",se,[n("div",{class:"fund-info",onClick:C=>P(o.code)},[n("div",oe,v(o.name),1),n("div",ne,v(o.code),1)],8,ae),p(a,{name:"cross",class:"remove-btn",onClick:C=>L(o.code)},null,8,["onClick"])]),o.estimate?(i(),d("div",le,[n("span",{class:B(parseFloat(o.estimate.gszzl)>=0?"up":"down")},v(parseFloat(o.estimate.gszzl)>=0?"+":"")+v(o.estimate.gszzl)+"% ",3),e[0]||(e[0]=n("span",{class:"change-label"},"今日涨幅",-1))])):_("",!0),o.loading?(i(),F(c,{key:1,size:"16"})):_("",!0)],4))),128)),s.value.length<y?(i(),d("div",{key:0,class:"add-card",onClick:w},[p(a,{name:"plus",size:"24"}),e[1]||(e[1]=n("span",null,"添加基金",-1))])):_("",!0)]),s.value.length>=2?(i(),d("div",re,[e[5]||(e[5]=n("div",{class:"section-title"},"收益率对比",-1)),n("div",ie,[n("div",ce,[e[2]||(e[2]=n("div",{class:"header-cell period"},"周期",-1)),(i(!0),d(h,null,k(s.value,(o,m)=>(i(),d("div",{key:o.code,class:"header-cell fund",style:R({color:b[m]})},v(o.name.slice(0,6)),5))),128))]),(i(),d(h,null,k(I,o=>n("div",{key:o.key,class:"table-row"},[n("div",ue,v(o.label),1),(i(!0),d(h,null,k(s.value,(m,C)=>(i(),d("div",{key:m.code,class:"row-cell fund"},[n("div",{class:B(["return-value",[(f(m,o.key)??0)>=0?"up":"down",T(s.value,o.key,m.code)]])},v(V(f(m,o.key))),3),n("div",{class:B(["return-bar",(f(m,o.key)??0)>=0?"up":"down"]),style:R({width:M(s.value,o.key,m.code),backgroundColor:b[C]})},null,6)]))),128))])),64))]),n("div",de,[n("span",me,[p(a,{name:"medal-o"}),e[3]||(e[3]=z(" 最优 ",-1))]),n("span",pe,[p(a,{name:"warning-o"}),e[4]||(e[4]=z(" 最差 ",-1))])])])):_("",!0),s.value.length<2?(i(),F(u,{key:1,description:"请至少选择2只基金进行对比"},{default:x(()=>[p(r,{round:"",type:"primary",size:"small",onClick:w},{default:x(()=>[...e[6]||(e[6]=[z(" 去添加 ",-1)])]),_:1})]),_:1})):_("",!0)])}}}),Fe=q(ve,[["__scopeId","data-v-2067fef1"]]);export{Fe as default};
